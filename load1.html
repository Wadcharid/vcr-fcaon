<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Training Load Calculator</title>
    <style>
        /* Style as per your original code */
    </style>
</head>
<body>

    <label for="menu">Choose a page:</label>
    <select id="menu" onchange="location = this.value;">
        <option value="">-- Select --</option>
        <option value="https://wadcharid.github.io/vcr-fcaon/vcr1.html">1.หาค่า VCR</option>
        <option value="https://wadcharid.github.io/vcr-fcaon/vcr2.html">2.หาโซนจาก VCR </option>
        <option value="https://wadcharid.github.io/vcr-fcaon/pace1.html">3.คำนวณ Pace,Distance,Time</option>
        <option value="https://wadcharid.github.io/vcr-fcaon/pace2.html">4.คำนวณ %Pace</option>
        <option value="https://wadcharid.github.io/vcr-fcaon/pace3.html">5.VCR Weekly Plan</option>
        <option value="https://wadcharid.github.io/vcr-fcaon/load1.html">6.COROS Load</option>
        <option value="https://wadcharid.github.io/vcr-fcaon/training1.html">7.Training Program</option>
    </select>
    
    <h1>Training Load Calculator</h1>
    <form onsubmit="calculateTrainingLoad(event)">
        <label for="weekly_tl">Weekly Training Load (TL):</label>
        <input type="number" id="weekly_tl" name="weekly_tl" required>
        
        <label for="phaseSelector">Select Phase:</label>
        <select id="phaseSelector">
            <option value="Base" selected>Base</option>
            <option value="Build">Build</option>
            <option value="Peak">Peak</option>
        </select>
        
        <label>VCR Pace:</label>
        <div class="inline">
            <input type="number" id="vcr_minutes" name="vcr_minutes" placeholder="Minutes" required>
            <input type="number" id="vcr_seconds" name="vcr_seconds" placeholder="Seconds" required>
        </div>
        
        <button type="submit">Calculate</button>
    </form>

    <div id="result" style="text-align: center; margin-top: 20px;"></div>
    <div id="daily-load"></div>

    <script>
        const zones = ['Z1', 'Z2', 'Z3', 'Z4-Z6'];
        let percentages = [0.2, 0.6, 0.15, 0.05]; // Default to Base
        const durationConstants = [0.8, 1.60, 2.58, 3.60];
        const distanceMultipliers = [0.7, 0.80, 0.9, 0.98];

        // Update percentages based on dropdown
        document.getElementById('phaseSelector').addEventListener('change', (event) => {
            const phase = event.target.value;
            switch (phase) {
                case 'Base':
                    percentages = [0.2, 0.6, 0.15, 0.05];
                    break;
                case 'Build':
                    percentages = [0.1, 0.55, 0.15, 0.2];
                    break;
                case 'Peak':
                    percentages = [0.1, 0.50, 0.2, 0.2];
                    break;
                default:
                    percentages = [0.2, 0.6, 0.15, 0.05]; // Default to Base
            }
            console.log(`Phase changed to: ${phase}, Percentages:`, percentages);
        });

        function calculateTrainingLoad(event) {
            event.preventDefault();

            const weeklyTL = parseInt(document.getElementById('weekly_tl').value);
            const vcrMinutes = parseInt(document.getElementById('vcr_minutes').value);
            const vcrSeconds = parseInt(document.getElementById('vcr_seconds').value);
            const vcrPaceSeconds = vcrMinutes * 60 + vcrSeconds;

            if (isNaN(weeklyTL) || isNaN(vcrMinutes) || isNaN(vcrSeconds)) {
                alert("Please fill out all fields!");
                return;
            }

            const zoneTL = percentages.map(p => Math.floor(weeklyTL * p));
            const durations = zoneTL.map((tl, i) => Math.ceil(tl / durationConstants[i]));
            const distances = durations.map((duration, i) => Math.ceil(duration * 60 * distanceMultipliers[i] / vcrPaceSeconds));

            let totalTL = 0, totalDuration = 0, totalDistance = 0;
            let tableHTML = '<table><tr><th>Zone</th><th>TL</th><th>Est. Duration (min)</th><th>Est. Distance (km)</th></tr>';

            zones.forEach((zone, i) => {
                totalTL += zoneTL[i];
                totalDuration += durations[i];
                totalDistance += distances[i];
                tableHTML += `<tr><td>${zone}</td><td>${zoneTL[i]}</td><td>${durations[i]}</td><td>${distances[i]}</td></tr>`;
            });

            tableHTML += `<tr><th>Total</th><th>${totalTL}</th><th>${totalDuration}</th><th>${totalDistance}</th></tr>`;
            tableHTML += '</table>';

            const dailyLoad = Math.floor(totalTL / 7);
            document.getElementById('result').innerHTML = tableHTML;
            document.getElementById('daily-load').innerHTML = `Daily Load: <strong>${dailyLoad}</strong>`;
        }
    </script>
</body>
</html>
